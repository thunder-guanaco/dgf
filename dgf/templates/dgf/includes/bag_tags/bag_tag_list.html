{% load i18n mathfilters %}

<div class="content">
    {% for friend in friends %}
        <div class="line">

            {% with bag_tag_difference=friend.bag_tag|sub:friend.previous_bag_tag %}

                <div class="news-best" data-bag-tag-difference="{{bag_tag_difference}}">
                </div>

                <div class="news
                        {% if bag_tag_difference < 0 %}
                            positive
                        {% elif bag_tag_difference > 0 %}
                            negative
                        {% elif bag_tag_difference == 0 %}
                            neutral
                        {% else %}
                            none
                        {% endif %}">
                    <span>{{bag_tag_difference|abs}}</span>
                </div>

            {% endwith %}

            {% if request.user.is_authenticated and request.user.friend.bag_tag %}

                <div class="number clickable"
                     data-bag-tag="{{friend.bag_tag}}"
                     data-username="{{friend.username}}"
                     data-url="{% url 'dgf:bag_tag_claim' friend.bag_tag %}"
                     onclick="bagTagClicked({{friend.bag_tag}})">
                    <span>{{friend.bag_tag}}</span>
                </div>
                <div class="player clickable"
                     data-bag-tag="{{friend.bag_tag}}"
                     data-username="{{friend.username}}"
                     onclick="bagTagClicked({{friend.bag_tag}})">
                    {% include "dgf/includes/friend_ball.html" with friend=friend %}
                    <div>
                        {{friend.short_name}}
                    </div>
                </div>

            {% else %}

                <div class="number">
                    <span>{{friend.bag_tag}}</span>
                </div>
                <div class="player">
                    {% include "dgf/includes/friend_ball.html" with friend=friend %}
                    <div>
                        {{friend.short_name}}
                    </div>
                </div>

            {% endif %}

            {% if not request.user_agent.is_mobile %}
                <div class="since">
                    {% trans " since " %} {{friend.since|date}}
                </div>
            {% endif %}
        </div>
    {% endfor %}
</div>
