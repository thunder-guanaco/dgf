{% load sekizai_tags static i18n dgf %}

{% addtoblock "css" %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/bag_tags.css' %}">
{% endaddtoblock %}

{% addtoblock "js" %}
    <script>
        const bagTagClaimText = "{% trans "Do you claim bag tag number " %}";
        const csrfToken = "{{csrf_token}}";
        const bagTagUpdateUrl = "{% url 'dgf:bag_tag_update' %}"
    </script>
    <script type="text/javascript" src="{% static 'js/bag_tags.js' %}"></script>
{% endaddtoblock %}

{% with request.user.is_authenticated as authenticated %}
    <div id="bag-tags">
        <div class="header">
            <h2>
                {% trans "Bag Tags" %}
            </h2>
            <button id="toggle-mode" onclick="toggleMultipleBagTagMode()">
                <span class="change">{% trans "Change multiple bag tags" %}</span>
                <span class="cancel" style="display: none;">{% trans "Cancel" %}</span>
            </button>
        </div>
        <div class="content">
            {% for friend in friends %}
                <div class="line">
                    {% if authenticated and request.user.friend.bag_tag %}
                        <div class="number clickable"
                             data-bag-tag="{{friend.bag_tag}}"
                             data-url="{% url 'dgf:bag_tag_claim' friend.bag_tag %}"
                             onclick="bagTagClicked({{friend.bag_tag}})">
                    {% else %}
                        <div class="number">
                    {% endif %}
                        <span>{{friend.bag_tag}}</span>
                    </div>
                    <div class="player" data-username="{{friend.username}}" data-bag-tag="{{friend.bag_tag}}">
                        {% include "dgf/includes/friend_ball.html" with friend=friend %}
                        <div>
                            {{friend.short_name}}
                        </div>
                    </div>
                    <div class="since desktop">
                        {% trans " seit " %} {{friend.since}}
                    </div>
                </div>
            {% endfor %}
        </div>
        <div class="footer">
            <button id="change-multiple-bag-tags" style="display: none;" onclick="changeMultipleBagTags()">
                {% trans "Change bag tags" %}
            </button>
        </div>
    </div>
    <div id="edit-bag-tags" style="display: none;">
        <h2>{% trans "Change the bag tags" %}</h2>
        <div id="multiple-bag-tag-lists">
            <ul id="multiple-bag-tag-numbers"></ul>
            <ul id="multiple-bag-tag-players"></ul>
        </div>
        <div id="multiple-bag-tag-error">
        </div>
        <div id="multiple-bag-tag-save">
            <button onclick="multipleBagTagsSave()">
                {% trans "Save" %}
            </button>
        </div>
    </div>
{% endwith %}
